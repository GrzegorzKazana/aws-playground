AWSTemplateFormatVersion: 2010-09-09
Transform: 'AWS::Serverless-2016-10-31'

Resources:
  HttpProxyFn:
    Type: AWS::Serverless::Function
    Properties:
      Runtime: nodejs14.x
      Handler: index.httpProxy
      Policies:
        - AWSLambdaBasicExecutionRole
      Events:
        default:
          Type: HttpApi
          Properties:
            # See comment below
            # ApiId: !Ref HttpApi
            Method: any
            Path: /proxy-integration

  # If no additional config has to be added, you can skip http api declaration.
  # Functions will be assigned to $default stage, which is served from api root.
  # You can still reference the resource via `ServerlessHttpApi`
  # For all autogenerated resources check out:
  # https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-specification-generated-resources.html
  #
  # HttpApi:
  #   Type: AWS::Serverless::HttpApi
  #   Properties: {}

Outputs:
  Endpoint:
    Value: !Sub "https://${ServerlessHttpApi}.execute-api.${AWS::Region}.amazonaws.com"
  Example:
    Value: !Sub "curl 'https://${ServerlessHttpApi}.execute-api.${AWS::Region}.amazonaws.com/proxy-integration?name=foo'"
  FunctionId:
    Value: !Ref HttpProxyFn